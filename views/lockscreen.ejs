<!DOCTYPE html>
<html lang="en">
<%- include('./components/header'); -%>

  <body class="hold-transition lockscreen">
    <div class="login-message-box">

    </div>
    <!-- Automatic element centering -->
    <div class="lockscreen-wrapper">
      <div class="lockscreen-logo">
        <a href="/login">ca
          <b>DO</b>log</a>
      </div>
      <!-- User name -->
      <div class="lockscreen-name">
        <%= authProfile.fullName %>
      </div>

      <!-- START LOCK SCREEN ITEM -->
      <div class="lockscreen-item">
        <!-- lockscreen image -->
        <div class="lockscreen-image">
          <img src="<%= authProfile.profileUrl %>" alt="User Image">
        </div>
        <!-- /.lockscreen-image -->

        <!-- lockscreen credentials (contains the form) -->
        <form class="lockscreen-credentials">
          <div class="input-group">
            <input type="password" class="form-control" placeholder="password" id="password">

            <div class="input-group-append">
              <button type="button" class="btn" onclick="lockscreen()">
                <i class="fa fa-arrow-right text-muted"></i>
              </button>
            </div>
          </div>
        </form>
        <!-- /.lockscreen credentials -->

      </div>
      <!-- /.lockscreen-item -->
      <div class="help-block text-center">
        Enter your password to retrieve your session
      </div>
      <div class="text-center">
        <a href="login">Or sign in as a different user</a>
      </div>

    </div>
    <!-- /.center -->

    <%- include('./components/scripts'); -%>
      <script>

        function lockscreen() {
          var lockscreendata = {

            "password": $("#password").val()
          }
          $.ajax({
            type: 'POST',
            dataType: "json",
            data: JSON.stringify(lockscreendata),
            contentType: 'application/json; charset=utf-8',
            url: '/controller/lockscreen',
            success: function (data) {
              console.log(data);
              $(".login-message-box").toggle();
              $(".login-message-box").html(
                '<div class="alert alert-success alert-dismissible" style="display:block; margin: 10px;"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button><h5><i class="icon fa fa-ban"></i> Success!</h5>Login successful. You are redirecting to the home page</div>'
              );
              $(".login-message-box").toggle(1500);

              setTimeout(function () {
                window.location.href = "/home"; //will redirect to your blog page (an ex: blog.html)
              }, 1500);
            },
            error: function (data) {
              console.log(data);
              $(".login-message-box").toggle();
              $(".login-message-box").html(
                '<div class="alert alert-danger alert-dismissible" style="display:block; margin: 10px;"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button><h5><i class="icon fa fa-ban"></i> Alert!</h5>Ops! Something went wrong. Please try to check the email and password.</div>'
              );
              $(".login-message-box").toggle(750);
            }
          });
        }
      </script>
  </body>

</html>